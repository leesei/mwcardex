var searchTimer;var searchTimeout=200;var fadeLongMs=300;var fadeShortMs=200;var trans1x1_gif="data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==";function dumpSpellDBEntry(a){entry=gSpellDB[a];console.debug('"%s": [%s] type[%s] sch[%s] cost[%d]',a,entry.name,entry.type,entry.schools,entry.cost)}$(document).ready(function(){init()});function init(){console.debug("init()");$("#page-mages-info").trigger("init");$("#page-spell-list").trigger("init");var b=$("#spell-img-holder");b.hide();b.on("load",function(){$(this).fadeIn(fadeLongMs)});$("#name-filter, #attr-filter").on("blur",function(d){d.preventDefault()});$("#name-filter, #attr-filter").on("search change",function(d){$("#page-spell-list").trigger("filterSpells")});var c=$("#school-filters input:checkbox");$("#school-filter-all").on("click",function(d){c.prop("checked",true);$("#page-spell-list").trigger("filterSpells")});$("#school-filter-none").on("click",function(d){c.prop("checked",false);$("#page-spell-list").trigger("filterSpells")});c.prop("checked",true);c.on("change",function(){$("#page-spell-list").trigger("filterSpells")});var a=$("#type-filters input:checkbox");$("#type-filter-all").on("click",function(){a.prop("checked",true);$("#page-spell-list").trigger("filterSpells")});$("#type-filter-none").on("click",function(){a.prop("checked",false);$("#page-spell-list").trigger("filterSpells")});a.prop("checked",true);a.on("change",function(){$("#page-spell-list").trigger("filterSpells")})}$("#page-mages-info").bind("init",function(){$("#page-mages-info").hide();var a=$("#page-mages-info input:radio");a.on("change",function(b){var c=b.target;$("#page-mages-info #mage-info-holder").html('<img src="mages/'+c.value+'_1.jpg" /> <img src="mages/'+c.value+'_2.jpg" />')});a[0].click()});$("#page-spell-list").bind("init",function(){var a=$("#page-spell-list #spell-list-holder");var b=$("#page-spell-list #spell-img-holder");$.each(gSpellDB,function(e,c){var d=$(sprintf('<li id="%s"><a href="#">%s</a></li>',e,c.name));d.on("click",function(f){f.preventDefault();if(b.attr("src").indexOf(e)==-1){b.hide();b.attr("src",sprintf("spells/%s.jpg",e))}});a.append(d);c.name=c.name.toLowerCase()});$(".nano").nanoScroller()});$("#page-spell-list").bind("filterSpells",function(){$("#page-spell-list #spell-img-holder").slideUp(fadeShortMs);var c=$("#page-spell-list #spell-list-holder li"),g;c.show();var h=$("#menu #school-filters input:checkbox");var f=h.filter(":checked");if(f.length==0){console.info("> [school] none selected, return");c.slideUp(fadeShortMs);return}else{if(f.length==h.length){console.info("> [school] skipped")}else{g=c.filter(":visible");console.log("> [school] filtering on %d checked, %d visible",f.length,g.length);g.filter(function(k){var j="";for(var i in gSpellDB[this.id].schools){j+="[value="+i+"] "}console.debug(">> [school] #%s '%s'",this.id,j);return(f.filter(j).length==0)}).hide()}}var b=$("#menu #type-filters input:checkbox");var e=b.filter(":checked");if(e.length==0){console.info("> [type] none selected, return");c.slideUp(fadeShortMs);return}else{if(e.length==b.length){console.info("> [type] skipped")}else{g=c.filter(":visible");console.log("> [type] filtering on %d checked, %d visible",e.length,g.length);g.filter(function(i){var j="[value="+gSpellDB[this.id].type+"]";console.debug(">> [type] #%s '%s'",this.id,j);return(e.filter(j).length==0)}).hide()}}var a=$("#menu #name-filter").val().toLowerCase();if(a.length){g=c.filter(":visible");console.log(sprintf("> [name] #%s '%s', %d visible",this.id,a,g.length));g.filter(function(i){return(gSpellDB[this.id].name.indexOf(a)==-1)}).hide()}else{console.info("> [name] skipped")}var d=$("#menu #attr-filter").val().toLowerCase();if(d.length){g=c.filter(":visible");console.log(sprintf("> [attr] filter: [%s], %d visible",d,g.length))}else{console.info("> [attr] skipped")}console.info("filter done, %d visible",c.filter(":visible").length)});